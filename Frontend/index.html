<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Tracking Frontend</title>
  <script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.2.7-rc.0/web3.min.js"></script>
  <!-- <script language="javascript" type="text/javascript" src="tracking_abi.js"></script> -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>


<body>
  <nav class="navbar navbar-expand-sm" style="background:rgb(5,45,71)">
	  <div class="container-fluid">	    
		<div class="collapse navbar-collapse " id="navbarSupportedContent">
		  <div class="mx-auto">
			<!-- <a class="navbar-brand " href="#">Navbar</a> -->
      <img src="../Images/Blockchain-and-logistics.jpg" alt="" width="300" class="img-fluid">
		</div>
    <a class="nav-link disabled pt-xl-5"  tabindex="-1">Logout</a>
		</div>
	  </div>
	</nav>

<section class="mt-5">
  <div class="container-fluid h-custom">
    <div class="row d-flex justify-content-center align-items-center mt-5">
      <div class="col-md-9 col-lg-6 col-xl-5 mt-5">
        <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-login-form/draw2.webp" class="img-fluid"
          alt="Sample image">
          <div class="d-grid gap-2 pt-xl-5 mt-5">
            <button class="btn btn-primary mt-2" type="button" onclick="dApp.loginWithEth()">Login With Metamask</button>
            <p id="userAddress" class="text-center mt-2"></p>
          </div>
      </div>
      


  <script language="javascript" type="text/javascript" src="functions.js"></script>

  <!-- <script>
    window.userAddress = null;
    window.onload = async () => {
      // Init Web3 connected to ETH network
      if (window.ethereum) {
        window.web3 = new Web3(window.ethereum);
      } else {
        alert("No ETH brower extension detected.");
      }

      // Load in Localstore key
      window.userAddress = window.localStorage.getItem("userAddress");
      showAddress();
    };


    // Display or remove the users know address on the frontend
    function showAddress() {
      if (!window.userAddress) {
        document.getElementById("userAddress").innerText = "";
        document.getElementById("logoutButton").classList.add("hidden");
        return false;
      }

      document.getElementById(
        "userAddress"
      ).innerText = `ETH Address: ${(window.userAddress)}`;
      document.getElementById("logoutButton").classList.remove("hidden");
    }

    // remove stored user address and reset frontend
    function logout() {
      window.userAddress = null;
      window.localStorage.removeItem("userAddress");
      showAddress();
    }

    function adminPage(){
      window.location.href = 'admin.html';
    }

    function courierPage(){
      window.location.href = 'courier.html';
    }

    function customerPage(){
      window.location.href = 'customer.html';
    }

    function accountNotFound(){
      document.getElementById("userAddress").innerText = "This address was not found in the contract, Try again!";
    }

    // Login with Web3 via Metamasks window.ethereum library
    async function loginWithEth() {
      if (window.web3) {
        try {
          // We use this since ethereum.enable() is deprecated. This method is not
          // available in Web3JS - so we call it directly from metamasks' library
          const selectedAccount = await window.ethereum
            .request({
              method: "eth_requestAccounts",
            })
            .then((accounts) => accounts[0])
            .catch(() => {
              throw Error("No account selected!");
            });
          window.userAddress = selectedAccount;
          window.localStorage.setItem("userAddress", selectedAccount);
          // showAddress();
          adminPage()
        } catch (error) {
          console.error(error);
        }
      } else {
        alert("No ETH brower extension detected.");
      }
    }
    </script> -->
</body>


</html>

<!---
https://www.youtube.com/watch?v=6Pyk9wbm1g4&ab_channel=ChrisAtMachine
--> 